--1
SELECT (SELECT CITY FROM LOCATIONS L WHERE L.LOCATION_ID=D.LOCATION_ID) "CITY NAME",
COUNT(DEPARTMENT_ID) TOTAL
FROM DEPARTMENTS D
WHERE LOCATION_ID IS NOT NULL
GROUP BY LOCATION_ID;


--2



--3
SELECT (SELECT C.COUNTRY_NAME FROM DEPARTMENTS D,LOCATIONS L, COUNTRIES C WHERE D.DEPARTMENT_ID=E.DEPARTMENT_ID AND D.LOCATION_ID=L.LOCATION_ID AND L.COUNTRY_ID=C.COUNTRY_ID)"COUNTRY NAME",TO_CHAR(NVL(MIN(HIRE_DATE),TO_DATE('01-JAN-1900', 'DD-MON-YYYY')),'MONTH/YYYY')
FROM EMPLOYEES E
WHERE DEPARTMENT_ID IS NOT NULL
GROUP BY DEPARTMENT_ID;

--4
SELECT DISTINCT (SELECT DEPARTMENT_NAME FROM DEPARTMENTS D WHERE D.DEPARTMENT_ID=E1.DEPARTMENT_ID)
"DEPARTMENT_NAME"
FROM EMPLOYEES E1
WHERE E1.SALARY>(
	SELECT E2.SALARY
	FROM EMPLOYEES E2
	WHERE E1.MANAGER_ID= E2.EMPLOYEE_ID
);

--5
(SELECT DISTINCT MANAGER_ID,(SELECT JOB_ID FROM EMPLOYEES E1 WHERE E1.EMPLOYEE_ID=E.MANAGER_ID) JOB_ID
FROM EMPLOYEES E)
INTERSECT
(SELECT EMPLOYEE_ID,JOB_ID  FROM JOB_HISTORY);


--6
SELECT (SELECT DEPARTMENT_NAME FROM DEPARTMENTS D1 WHERE D1.DEPARTMENT_ID=(SELECT DEPARTMENT_ID FROM EMPLOYEES E WHERE E.EMPLOYEE_ID=D.EMPLOYEE_ID))
FROM (SELECT EMPLOYEE_ID,JOB_ID FROM EMPLOYEES) MINUS (SELECT EMPLOYEE_ID,JOB_ID FROM JOB_HISTORY) D, (SELECT EMPLOYEE_ID,JOB_ID FROM EMPLOYEES) INTERSECT (SELECT EMPLOYEE_ID,JOB_ID FROM JOB_HISTORY) DD
WHERE AVG(SELECT SALARY FROM EMPLOYEES WHERE D.EMPLOYEE_ID=E.EMPLOYEE_ID)>AVG(SELECT SALARY FROM EMPLOYEES WHERE DD.EMPLOYEE_ID=E.EMPLOYEE_ID);